imp.enableblinkup(true);

const bits = "\xC0\x30\x0C\x03\x00\xC0\x30\x0C\x03\x00\xC0\x30\x0C\x03\x00\xC0\x30\x0C\x03\xE0\xC0\x30\x0C\x03\x00\xC0\x30\x0F\x83\x00\xC0\x30\x0C\x03\x00\xC0\x30\x0F\x83\xE0\xC0\x30\x0C\x03\x00\xC0\x3E\x0C\x03\x00\xC0\x30\x0C\x03\x00\xC0\x3E\x0C\x03\xE0\xC0\x30\x0C\x03\x00\xC0\x3E\x0F\x83\x00\xC0\x30\x0C\x03\x00\xC0\x3E\x0F\x83\xE0\xC0\x30\x0C\x03\x00\xF8\x30\x0C\x03\x00\xC0\x30\x0C\x03\x00\xF8\x30\x0C\x03\xE0\xC0\x30\x0C\x03\x00\xF8\x30\x0F\x83\x00\xC0\x30\x0C\x03\x00\xF8\x30\x0F\x83\xE0\xC0\x30\x0C\x03\x00\xF8\x3E\x0C\x03\x00\xC0\x30\x0C\x03\x00\xF8\x3E\x0C\x03\xE0\xC0\x30\x0C\x03\x00\xF8\x3E\x0F\x83\x00\xC0\x30\x0C\x03\x00\xF8\x3E\x0F\x83\xE0\xC0\x30\x0C\x03\xE0\xC0\x30\x0C\x03\x00\xC0\x30\x0C\x03\xE0\xC0\x30\x0C\x03\xE0\xC0\x30\x0C\x03\xE0\xC0\x30\x0F\x83\x00\xC0\x30\x0C\x03\xE0\xC0\x30\x0F\x83\xE0\xC0\x30\x0C\x03\xE0\xC0\x3E\x0C\x03\x00\xC0\x30\x0C\x03\xE0\xC0\x3E\x0C\x03\xE0\xC0\x30\x0C\x03\xE0\xC0\x3E\x0F\x83\x00\xC0\x30\x0C\x03\xE0\xC0\x3E\x0F\x83\xE0\xC0\x30\x0C\x03\xE0\xF8\x30\x0C\x03\x00\xC0\x30\x0C\x03\xE0\xF8\x30\x0C\x03\xE0\xC0\x30\x0C\x03\xE0\xF8\x30\x0F\x83\x00\xC0\x30\x0C\x03\xE0\xF8\x30\x0F\x83\xE0\xC0\x30\x0C\x03\xE0\xF8\x3E\x0C\x03\x00\xC0\x30\x0C\x03\xE0\xF8\x3E\x0C\x03\xE0\xC0\x30\x0C\x03\xE0\xF8\x3E\x0F\x83\x00\xC0\x30\x0C\x03\xE0\xF8\x3E\x0F\x83\xE0\xC0\x30\x0F\x83\x00\xC0\x30\x0C\x03\x00\xC0\x30\x0F\x83\x00\xC0\x30\x0C\x03\xE0\xC0\x30\x0F\x83\x00\xC0\x30\x0F\x83\x00\xC0\x30\x0F\x83\x00\xC0\x30\x0F\x83\xE0\xC0\x30\x0F\x83\x00\xC0\x3E\x0C\x03\x00\xC0\x30\x0F\x83\x00\xC0\x3E\x0C\x03\xE0\xC0\x30\x0F\x83\x00\xC0\x3E\x0F\x83\x00\xC0\x30\x0F\x83\x00\xC0\x3E\x0F\x83\xE0\xC0\x30\x0F\x83\x00\xF8\x30\x0C\x03\x00\xC0\x30\x0F\x83\x00\xF8\x30\x0C\x03\xE0\xC0\x30\x0F\x83\x00\xF8\x30\x0F\x83\x00\xC0\x30\x0F\x83\x00\xF8\x30\x0F\x83\xE0\xC0\x30\x0F\x83\x00\xF8\x3E\x0C\x03\x00\xC0\x30\x0F\x83\x00\xF8\x3E\x0C\x03\xE0\xC0\x30\x0F\x83\x00\xF8\x3E\x0F\x83\x00\xC0\x30\x0F\x83\x00\xF8\x3E\x0F\x83\xE0\xC0\x30\x0F\x83\xE0\xC0\x30\x0C\x03\x00\xC0\x30\x0F\x83\xE0\xC0\x30\x0C\x03\xE0\xC0\x30\x0F\x83\xE0\xC0\x30\x0F\x83\x00\xC0\x30\x0F\x83\xE0\xC0\x30\x0F\x83\xE0\xC0\x30\x0F\x83\xE0\xC0\x3E\x0C\x03\x00\xC0\x30\x0F\x83\xE0\xC0\x3E\x0C\x03\xE0\xC0\x30\x0F\x83\xE0\xC0\x3E\x0F\x83\x00\xC0\x30\x0F\x83\xE0\xC0\x3E\x0F\x83\xE0\xC0\x30\x0F\x83\xE0\xF8\x30\x0C\x03\x00\xC0\x30\x0F\x83\xE0\xF8\x30\x0C\x03\xE0\xC0\x30\x0F\x83\xE0\xF8\x30\x0F\x83\x00\xC0\x30\x0F\x83\xE0\xF8\x30\x0F\x83\xE0\xC0\x30\x0F\x83\xE0\xF8\x3E\x0C\x03\x00\xC0\x30\x0F\x83\xE0\xF8\x3E\x0C\x03\xE0\xC0\x30\x0F\x83\xE0\xF8\x3E\x0F\x83\x00\xC0\x30\x0F\x83\xE0\xF8\x3E\x0F\x83\xE0\xC0\x3E\x0C\x03\x00\xC0\x30\x0C\x03\x00\xC0\x3E\x0C\x03\x00\xC0\x30\x0C\x03\xE0\xC0\x3E\x0C\x03\x00\xC0\x30\x0F\x83\x00\xC0\x3E\x0C\x03\x00\xC0\x30\x0F\x83\xE0\xC0\x3E\x0C\x03\x00\xC0\x3E\x0C\x03\x00\xC0\x3E\x0C\x03\x00\xC0\x3E\x0C\x03\xE0\xC0\x3E\x0C\x03\x00\xC0\x3E\x0F\x83\x00\xC0\x3E\x0C\x03\x00\xC0\x3E\x0F\x83\xE0\xC0\x3E\x0C\x03\x00\xF8\x30\x0C\x03\x00\xC0\x3E\x0C\x03\x00\xF8\x30\x0C\x03\xE0\xC0\x3E\x0C\x03\x00\xF8\x30\x0F\x83\x00\xC0\x3E\x0C\x03\x00\xF8\x30\x0F\x83\xE0\xC0\x3E\x0C\x03\x00\xF8\x3E\x0C\x03\x00\xC0\x3E\x0C\x03\x00\xF8\x3E\x0C\x03\xE0\xC0\x3E\x0C\x03\x00\xF8\x3E\x0F\x83\x00\xC0\x3E\x0C\x03\x00\xF8\x3E\x0F\x83\xE0\xC0\x3E\x0C\x03\xE0\xC0\x30\x0C\x03\x00\xC0\x3E\x0C\x03\xE0\xC0\x30\x0C\x03\xE0\xC0\x3E\x0C\x03\xE0\xC0\x30\x0F\x83\x00\xC0\x3E\x0C\x03\xE0\xC0\x30\x0F\x83\xE0\xC0\x3E\x0C\x03\xE0\xC0\x3E\x0C\x03\x00\xC0\x3E\x0C\x03\xE0\xC0\x3E\x0C\x03\xE0\xC0\x3E\x0C\x03\xE0\xC0\x3E\x0F\x83\x00\xC0\x3E\x0C\x03\xE0\xC0\x3E\x0F\x83\xE0\xC0\x3E\x0C\x03\xE0\xF8\x30\x0C\x03\x00\xC0\x3E\x0C\x03\xE0\xF8\x30\x0C\x03\xE0\xC0\x3E\x0C\x03\xE0\xF8\x30\x0F\x83\x00\xC0\x3E\x0C\x03\xE0\xF8\x30\x0F\x83\xE0\xC0\x3E\x0C\x03\xE0\xF8\x3E\x0C\x03\x00\xC0\x3E\x0C\x03\xE0\xF8\x3E\x0C\x03\xE0\xC0\x3E\x0C\x03\xE0\xF8\x3E\x0F\x83\x00\xC0\x3E\x0C\x03\xE0\xF8\x3E\x0F\x83\xE0\xC0\x3E\x0F\x83\x00\xC0\x30\x0C\x03\x00\xC0\x3E\x0F\x83\x00\xC0\x30\x0C\x03\xE0\xC0\x3E\x0F\x83\x00\xC0\x30\x0F\x83\x00\xC0\x3E\x0F\x83\x00\xC0\x30\x0F\x83\xE0\xC0\x3E\x0F\x83\x00\xC0\x3E\x0C\x03\x00\xC0\x3E\x0F\x83\x00\xC0\x3E\x0C\x03\xE0\xC0\x3E\x0F\x83\x00\xC0\x3E\x0F\x83\x00\xC0\x3E\x0F\x83\x00\xC0\x3E\x0F\x83\xE0\xC0\x3E\x0F\x83\x00\xF8\x30\x0C\x03\x00\xC0\x3E\x0F\x83\x00\xF8\x30\x0C\x03\xE0\xC0\x3E\x0F\x83\x00\xF8\x30\x0F\x83\x00\xC0\x3E\x0F\x83\x00\xF8\x30\x0F\x83\xE0\xC0\x3E\x0F\x83\x00\xF8\x3E\x0C\x03\x00\xC0\x3E\x0F\x83\x00\xF8\x3E\x0C\x03\xE0\xC0\x3E\x0F\x83\x00\xF8\x3E\x0F\x83\x00\xC0\x3E\x0F\x83\x00\xF8\x3E\x0F\x83\xE0\xC0\x3E\x0F\x83\xE0\xC0\x30\x0C\x03\x00\xC0\x3E\x0F\x83\xE0\xC0\x30\x0C\x03\xE0\xC0\x3E\x0F\x83\xE0\xC0\x30\x0F\x83\x00\xC0\x3E\x0F\x83\xE0\xC0\x30\x0F\x83\xE0\xC0\x3E\x0F\x83\xE0\xC0\x3E\x0C\x03\x00\xC0\x3E\x0F\x83\xE0\xC0\x3E\x0C\x03\xE0\xC0\x3E\x0F\x83\xE0\xC0\x3E\x0F\x83\x00\xC0\x3E\x0F\x83\xE0\xC0\x3E\x0F\x83\xE0\xC0\x3E\x0F\x83\xE0\xF8\x30\x0C\x03\x00\xC0\x3E\x0F\x83\xE0\xF8\x30\x0C\x03\xE0\xC0\x3E\x0F\x83\xE0\xF8\x30\x0F\x83\x00\xC0\x3E\x0F\x83\xE0\xF8\x30\x0F\x83\xE0\xC0\x3E\x0F\x83\xE0\xF8\x3E\x0C\x03\x00\xC0\x3E\x0F\x83\xE0\xF8\x3E\x0C\x03\xE0\xC0\x3E\x0F\x83\xE0\xF8\x3E\x0F\x83\x00\xC0\x3E\x0F\x83\xE0\xF8\x3E\x0F\x83\xE0\xF8\x30\x0C\x03\x00\xC0\x30\x0C\x03\x00\xF8\x30\x0C\x03\x00\xC0\x30\x0C\x03\xE0\xF8\x30\x0C\x03\x00\xC0\x30\x0F\x83\x00\xF8\x30\x0C\x03\x00\xC0\x30\x0F\x83\xE0\xF8\x30\x0C\x03\x00\xC0\x3E\x0C\x03\x00\xF8\x30\x0C\x03\x00\xC0\x3E\x0C\x03\xE0\xF8\x30\x0C\x03\x00\xC0\x3E\x0F\x83\x00\xF8\x30\x0C\x03\x00\xC0\x3E\x0F\x83\xE0\xF8\x30\x0C\x03\x00\xF8\x30\x0C\x03\x00\xF8\x30\x0C\x03\x00\xF8\x30\x0C\x03\xE0\xF8\x30\x0C\x03\x00\xF8\x30\x0F\x83\x00\xF8\x30\x0C\x03\x00\xF8\x30\x0F\x83\xE0\xF8\x30\x0C\x03\x00\xF8\x3E\x0C\x03\x00\xF8\x30\x0C\x03\x00\xF8\x3E\x0C\x03\xE0\xF8\x30\x0C\x03\x00\xF8\x3E\x0F\x83\x00\xF8\x30\x0C\x03\x00\xF8\x3E\x0F\x83\xE0\xF8\x30\x0C\x03\xE0\xC0\x30\x0C\x03\x00\xF8\x30\x0C\x03\xE0\xC0\x30\x0C\x03\xE0\xF8\x30\x0C\x03\xE0\xC0\x30\x0F\x83\x00\xF8\x30\x0C\x03\xE0\xC0\x30\x0F\x83\xE0\xF8\x30\x0C\x03\xE0\xC0\x3E\x0C\x03\x00\xF8\x30\x0C\x03\xE0\xC0\x3E\x0C\x03\xE0\xF8\x30\x0C\x03\xE0\xC0\x3E\x0F\x83\x00\xF8\x30\x0C\x03\xE0\xC0\x3E\x0F\x83\xE0\xF8\x30\x0C\x03\xE0\xF8\x30\x0C\x03\x00\xF8\x30\x0C\x03\xE0\xF8\x30\x0C\x03\xE0\xF8\x30\x0C\x03\xE0\xF8\x30\x0F\x83\x00\xF8\x30\x0C\x03\xE0\xF8\x30\x0F\x83\xE0\xF8\x30\x0C\x03\xE0\xF8\x3E\x0C\x03\x00\xF8\x30\x0C\x03\xE0\xF8\x3E\x0C\x03\xE0\xF8\x30\x0C\x03\xE0\xF8\x3E\x0F\x83\x00\xF8\x30\x0C\x03\xE0\xF8\x3E\x0F\x83\xE0\xF8\x30\x0F\x83\x00\xC0\x30\x0C\x03\x00\xF8\x30\x0F\x83\x00\xC0\x30\x0C\x03\xE0\xF8\x30\x0F\x83\x00\xC0\x30\x0F\x83\x00\xF8\x30\x0F\x83\x00\xC0\x30\x0F\x83\xE0\xF8\x30\x0F\x83\x00\xC0\x3E\x0C\x03\x00\xF8\x30\x0F\x83\x00\xC0\x3E\x0C\x03\xE0\xF8\x30\x0F\x83\x00\xC0\x3E\x0F\x83\x00\xF8\x30\x0F\x83\x00\xC0\x3E\x0F\x83\xE0\xF8\x30\x0F\x83\x00\xF8\x30\x0C\x03\x00\xF8\x30\x0F\x83\x00\xF8\x30\x0C\x03\xE0\xF8\x30\x0F\x83\x00\xF8\x30\x0F\x83\x00\xF8\x30\x0F\x83\x00\xF8\x30\x0F\x83\xE0\xF8\x30\x0F\x83\x00\xF8\x3E\x0C\x03\x00\xF8\x30\x0F\x83\x00\xF8\x3E\x0C\x03\xE0\xF8\x30\x0F\x83\x00\xF8\x3E\x0F\x83\x00\xF8\x30\x0F\x83\x00\xF8\x3E\x0F\x83\xE0\xF8\x30\x0F\x83\xE0\xC0\x30\x0C\x03\x00\xF8\x30\x0F\x83\xE0\xC0\x30\x0C\x03\xE0\xF8\x30\x0F\x83\xE0\xC0\x30\x0F\x83\x00\xF8\x30\x0F\x83\xE0\xC0\x30\x0F\x83\xE0\xF8\x30\x0F\x83\xE0\xC0\x3E\x0C\x03\x00\xF8\x30\x0F\x83\xE0\xC0\x3E\x0C\x03\xE0\xF8\x30\x0F\x83\xE0\xC0\x3E\x0F\x83\x00\xF8\x30\x0F\x83\xE0\xC0\x3E\x0F\x83\xE0\xF8\x30\x0F\x83\xE0\xF8\x30\x0C\x03\x00\xF8\x30\x0F\x83\xE0\xF8\x30\x0C\x03\xE0\xF8\x30\x0F\x83\xE0\xF8\x30\x0F\x83\x00\xF8\x30\x0F\x83\xE0\xF8\x30\x0F\x83\xE0\xF8\x30\x0F\x83\xE0\xF8\x3E\x0C\x03\x00\xF8\x30\x0F\x83\xE0\xF8\x3E\x0C\x03\xE0\xF8\x30\x0F\x83\xE0\xF8\x3E\x0F\x83\x00\xF8\x30\x0F\x83\xE0\xF8\x3E\x0F\x83\xE0\xF8\x3E\x0C\x03\x00\xC0\x30\x0C\x03\x00\xF8\x3E\x0C\x03\x00\xC0\x30\x0C\x03\xE0\xF8\x3E\x0C\x03\x00\xC0\x30\x0F\x83\x00\xF8\x3E\x0C\x03\x00\xC0\x30\x0F\x83\xE0\xF8\x3E\x0C\x03\x00\xC0\x3E\x0C\x03\x00\xF8\x3E\x0C\x03\x00\xC0\x3E\x0C\x03\xE0\xF8\x3E\x0C\x03\x00\xC0\x3E\x0F\x83\x00\xF8\x3E\x0C\x03\x00\xC0\x3E\x0F\x83\xE0\xF8\x3E\x0C\x03\x00\xF8\x30\x0C\x03\x00\xF8\x3E\x0C\x03\x00\xF8\x30\x0C\x03\xE0\xF8\x3E\x0C\x03\x00\xF8\x30\x0F\x83\x00\xF8\x3E\x0C\x03\x00\xF8\x30\x0F\x83\xE0\xF8\x3E\x0C\x03\x00\xF8\x3E\x0C\x03\x00\xF8\x3E\x0C\x03\x00\xF8\x3E\x0C\x03\xE0\xF8\x3E\x0C\x03\x00\xF8\x3E\x0F\x83\x00\xF8\x3E\x0C\x03\x00\xF8\x3E\x0F\x83\xE0\xF8\x3E\x0C\x03\xE0\xC0\x30\x0C\x03\x00\xF8\x3E\x0C\x03\xE0\xC0\x30\x0C\x03\xE0\xF8\x3E\x0C\x03\xE0\xC0\x30\x0F\x83\x00\xF8\x3E\x0C\x03\xE0\xC0\x30\x0F\x83\xE0\xF8\x3E\x0C\x03\xE0\xC0\x3E\x0C\x03\x00\xF8\x3E\x0C\x03\xE0\xC0\x3E\x0C\x03\xE0\xF8\x3E\x0C\x03\xE0\xC0\x3E\x0F\x83\x00\xF8\x3E\x0C\x03\xE0\xC0\x3E\x0F\x83\xE0\xF8\x3E\x0C\x03\xE0\xF8\x30\x0C\x03\x00\xF8\x3E\x0C\x03\xE0\xF8\x30\x0C\x03\xE0\xF8\x3E\x0C\x03\xE0\xF8\x30\x0F\x83\x00\xF8\x3E\x0C\x03\xE0\xF8\x30\x0F\x83\xE0\xF8\x3E\x0C\x03\xE0\xF8\x3E\x0C\x03\x00\xF8\x3E\x0C\x03\xE0\xF8\x3E\x0C\x03\xE0\xF8\x3E\x0C\x03\xE0\xF8\x3E\x0F\x83\x00\xF8\x3E\x0C\x03\xE0\xF8\x3E\x0F\x83\xE0\xF8\x3E\x0F\x83\x00\xC0\x30\x0C\x03\x00\xF8\x3E\x0F\x83\x00\xC0\x30\x0C\x03\xE0\xF8\x3E\x0F\x83\x00\xC0\x30\x0F\x83\x00\xF8\x3E\x0F\x83\x00\xC0\x30\x0F\x83\xE0\xF8\x3E\x0F\x83\x00\xC0\x3E\x0C\x03\x00\xF8\x3E\x0F\x83\x00\xC0\x3E\x0C\x03\xE0\xF8\x3E\x0F\x83\x00\xC0\x3E\x0F\x83\x00\xF8\x3E\x0F\x83\x00\xC0\x3E\x0F\x83\xE0\xF8\x3E\x0F\x83\x00\xF8\x30\x0C\x03\x00\xF8\x3E\x0F\x83\x00\xF8\x30\x0C\x03\xE0\xF8\x3E\x0F\x83\x00\xF8\x30\x0F\x83\x00\xF8\x3E\x0F\x83\x00\xF8\x30\x0F\x83\xE0\xF8\x3E\x0F\x83\x00\xF8\x3E\x0C\x03\x00\xF8\x3E\x0F\x83\x00\xF8\x3E\x0C\x03\xE0\xF8\x3E\x0F\x83\x00\xF8\x3E\x0F\x83\x00\xF8\x3E\x0F\x83\x00\xF8\x3E\x0F\x83\xE0\xF8\x3E\x0F\x83\xE0\xC0\x30\x0C\x03\x00\xF8\x3E\x0F\x83\xE0\xC0\x30\x0C\x03\xE0\xF8\x3E\x0F\x83\xE0\xC0\x30\x0F\x83\x00\xF8\x3E\x0F\x83\xE0\xC0\x30\x0F\x83\xE0\xF8\x3E\x0F\x83\xE0\xC0\x3E\x0C\x03\x00\xF8\x3E\x0F\x83\xE0\xC0\x3E\x0C\x03\xE0\xF8\x3E\x0F\x83\xE0\xC0\x3E\x0F\x83\x00\xF8\x3E\x0F\x83\xE0\xC0\x3E\x0F\x83\xE0\xF8\x3E\x0F\x83\xE0\xF8\x30\x0C\x03\x00\xF8\x3E\x0F\x83\xE0\xF8\x30\x0C\x03\xE0\xF8\x3E\x0F\x83\xE0\xF8\x30\x0F\x83\x00\xF8\x3E\x0F\x83\xE0\xF8\x30\x0F\x83\xE0\xF8\x3E\x0F\x83\xE0\xF8\x3E\x0C\x03\x00\xF8\x3E\x0F\x83\xE0\xF8\x3E\x0C\x03\xE0\xF8\x3E\x0F\x83\xE0\xF8\x3E\x0F\x83\x00\xF8\x3E\x0F\x83\xE0\xF8\x3E\x0F\x83\xE0";

class neoPixels {
    spi = null;
    frameSize = null;
    frame = null;

    // _spi - A configured spi (MSB_FIRST, 7.5MHz)
    // _frameSize - Number of Pixels per frame
    constructor(_spi, _frameSize) {
        this.spi = _spi;
        this.frameSize = _frameSize;
        this.frame = blob(frameSize*30 + 20);
        
        clearFrame();
        writeFrame();
    }

    // sets (but does not output) a pixel in frame buffer to a specific color
    // You must call writeFrame before the changes are output to the hardware
    function writePixel(p,r,g,b) {
        frame.seek(p*30);
        local i = 0;
        
        for (i = 0 ; i < 10; i++) frame.writen(bits[g*10 + i],'c');
        for (i = 0 ; i < 10; i++) frame.writen(bits[r*10 + i],'c');
        for (i = 0 ; i < 10; i++) frame.writen(bits[b*10 + i],'c');
    }
    
    // Clears (but does not output) the frame buffer.
    function clearFrame() {
      for (local p = 0; p < frameSize; p++) writePixel(p,0,0,0);
      for (local i = 0; i < 20; i++) frame.writen(0x00,'c');
    }
    
    // Writes the current frame buffer to the PixelStrip
    // This function updates the hardware.
    function writeFrame() {
        spi.write(frame);
    }
}

const NUMPIXELS = 30;
const DELAY = 0.025;

spi <- hardware.spi257;
spi.configure(MSB_FIRST, 7500);
pixelStrip <- neoPixels(spi, NUMPIXELS);

function animationLoop() {
    // clear the frame buffer
    pixelStrip.clearFrame();

    local r = 0;
    local g = 0;
    local b = 0;
    
    // update the frame buffer by updating each pixel
    for(local i = 0; i < NUMPIXELS; i++) {
        pixelStrip.writePixel(i, r,g,b);
    }
    
    // write the framebuffer to the pixelStrip
    pixelStrip.writeFrame();
    imp.wakeup(DELAY, animationLoop);
}

animationLoop();
